/*! tink-datepicker-angular v1.1.5 */
"use strict";!function(module){try{module=angular.module("tink.datepicker")}catch(e){module=angular.module("tink.datepicker",["tink.datehelper","tink.safeApply","tink.formathelper"])}module.directive("tinkDatepicker",["$q","$templateCache","$http","$compile","dateCalculator","calView","safeApply","$window","$sce","$timeout",function($q,$templateCache,$http,$compile,dateCalculator,calView,safeApply,$window,$sce,setTimeout){return{restrict:"E",require:["ngModel","?^form"],replace:!0,templateUrl:"templates/tinkDatePickerInput.html",scope:{ngModel:"=?",minDate:"=?",maxDate:"=?",isDisabled:"=?",name:"="},compile:function(template,$attr){return $attr.required&&($attr.required=!1,template.find("input").attr("data-require",!0),template.find("input").attr("name",template.attr("name"))),{pre:function(){},post:function(scope,element,attr){function disableElements(el){for(var i=0;i<el.length;i++)$(el[i]).attr("disabled","disabled"),$(el[i]).attr("tabindex","-1"),disableElements(el[i].children)}function enableElements(el){for(var i=0;i<el.length;i++)$(el[i]).removeAttr("disabled","disabled"),$(el[i]).removeAttr("tabindex","-1"),disableElements(el[i].children)}function addTime(date1,date2){angular.isDate(date1)&&angular.isDate(date2)&&(date1.setMinutes(date2.getMinutes()),date1.setHours(date2.getHours()),date1.setMilliseconds(date2.getMilliseconds()))}function bindLiseners(){function childOf(c,p){for(;(c=c.parentNode)&&c!==p;);return!!c}Liseners.windowClick=function(event){$directive.open&&(childOf(event.target,copyEl.get(0))||childOf(event.target,element.get(0))||$directive.click||scope.hide(),$directive.click=0)},Liseners.windowKeydown=function(event){$directive.open&&safeApply(scope,function(){!currentSelected||38!==event.which&&37!==event.which&&39!==event.which&&40!==event.which?9===event.keyCode?(content.bindFirst("blur.disable",function(e){return e.stopImmediatePropagation(),!1}),event.preventDefault(),setFocusButton()):currentSelected&&13!==event.keyCode&&(content.focus(),currentSelected=null):(event.preventDefault(),calcFocus(event.which))})},$($window).bind("click",Liseners.windowClick),$($window).bind("keydown",Liseners.windowKeydown)}function validFormat(date,format){var dateObject;if(angular.isDefined(date)&&null!==date){if("string"==typeof date){if(10!==date.length)return!1;if(!isTouch&&!/^(?:(?:31(\/)(?:0?[13578]|1[02]))\1|(?:(?:29|30)(\/|)(?:0?[1,3-9]|1[0-2])\2))(?:(?:1[6-9]|[2-9]\d)?\d{2})$|^(?:29(\/)0?2\3(?:(?:(?:1[6-9]|[2-9]\d)?(?:0[48]|[2468][048]|[13579][26])|(?:(?:16|[2468][048]|[3579][26])00))))$|^(?:0?[1-9]|1\d|2[0-8])(\/|)(?:(?:0?[1-9])|(?:1[0-2]))\4(?:(?:1[6-9]|[2-9]\d)?\d{2})$/.test(date))return!1;dateObject=dateCalculator.getDate(date,format)}else{if(!angular.isDate(date))return"function"==typeof date?validFormat(date(),format):!1;dateObject=date}return"Invalid Date"!==dateObject.toString()}}function removeLiseners(){$($window).unbind("click",Liseners.windowClick),$($window).unbind("keydown",Liseners.windowKeydown)}function setFocusButton(btn,focus){setTimeout(function(){if(currentSelected&&currentSelected.attr("aria-selected","false"),btn)btn.attr("aria-selected","true"),focus!==!1&&btn.focus(),currentSelected=btn;else if(0!==$(copyEl.find(".btn-today")).length)$(copyEl.find(".btn-today")).attr("aria-selected","true"),$(copyEl.find(".btn-today")).focus(),currentSelected=$(copyEl.find(".btn-today"));else{var firstTb=$(copyEl.find("tbody button:not(.btn-grayed):first"));firstTb.attr("aria-selected","true"),firstTb.focus(),currentSelected=firstTb}},10)}function calcLast(){var viewDate=$directive.viewDate,firstdate=scope.minDate,lastNum=new Date(viewDate.getFullYear(),viewDate.getMonth()+1,0,0,0,0);return!dateCalculator.isSameDate(lastNum,firstdate)}function calcFirst(){var viewDate=$directive.viewDate,lastdate=scope.maxDate,firstNum=new Date(viewDate.getFullYear(),viewDate.getMonth()+1,1,0,0,0),current=new Date(viewDate.getFullYear(),viewDate.getMonth()+1,0,0,0,0);return!(dateCalculator.isSameDate(firstNum,lastdate)||dateCalculator.isSameDate(current,lastdate))}function calcFocus(e){var calcPos,btn,rijen=copyEl.find("tbody").children(),rijIndex=rijen.index(currentSelected.closest("tr"));if(-1!==rijIndex){var kolommen=$(rijen[rijIndex]).children(),kolomIndex=kolommen.index(currentSelected.closest("td"));37===e?0===rijIndex&&0===kolomIndex?(!angular.isDate(scope.minDate)||calcLast())&&scope.$selectPane(-1,!0):kolomIndex>0?(btn=$($(kolommen[kolomIndex-1]).find("button")),btn.hasClass("btn-grayed")&&!btn.is(":disabled")?scope.$selectPane(-1,!0):calcPos=btn):calcPos=$($(rijen[rijIndex-1]).children()[$(rijen[rijIndex-1]).children().length-1]).find("button"):39===e?rijIndex===rijen.length-1&&kolomIndex===$(rijen[rijIndex]).children().length-1?calcFirst()&&scope.$selectPane(1,!0):kolomIndex<kolommen.length-1?(btn=$($(kolommen[kolomIndex+1]).find("button")),btn.hasClass("btn-grayed")&&!btn.is(":disabled")?scope.$selectPane(1,!0):calcPos=btn):calcPos=$($(rijen[rijIndex+1]).children()[0]).find("button"):38===e?rijIndex>0?(btn=$($(rijen[rijIndex-1]).children()[kolomIndex]).find("button"),btn.hasClass("btn-grayed")&&!btn.is(":disabled")?scope.$selectPane(-1,!0):calcPos=btn):scope.$selectPane(-1,!0):40===e&&(rijIndex<rijen.length-1?(btn=$($(rijen[rijIndex+1]).children()[kolomIndex]).find("button"),btn.hasClass("btn-grayed")&&!btn.is(":disabled")?scope.$selectPane(1,!0):calcPos=btn):calcFirst()&&scope.$selectPane(1,!0)),calcPos&&!calcPos.is(":disabled")&&setFocusButton(calcPos)}}function setMode(mode){switch(mode>=0&&2>=mode?$directive.mode=mode:$directive.mode=0,$directive.pane={},$directive.mode){case 0:$directive.pane.month=1;break;case 1:$directive.pane.month=12;break;case 2:$directive.pane.year=12}}function checkBefore(date,before){if(!angular.isDate(date))return!1;if(!angular.isDate(before))return!1;var copyDate=new Date(date.getFullYear(),date.getMonth(),1),copyBefore=new Date(before.getFullYear(),before.getMonth(),1);return dateCalculator.dateBeforeOther(copyBefore,copyDate)?!0:!1}function checkAfter(date,after){if(!angular.isDate(date))return!1;if(!angular.isDate(after))return!1;var copyDate=new Date(date.getFullYear(),date.getMonth(),1,0,0,0),copyafter=new Date(after.getFullYear(),after.getMonth(),1,0,0,0);return dateCalculator.dateBeforeOther(copyafter,copyDate)&&copyafter.getTime()!==copyDate.getTime()?!1:!0}function haalTemplateOp(template){return fetchPromises[template]?fetchPromises[template]:fetchPromises[template]=$q.when($templateCache.get(template)||$http.get(template)).then(function(res){return angular.isObject(res)?($templateCache.put(template,res.data),res.data):res})}scope.name=attr.name,scope.opts=attr;var copyEl,$directive={viewDate:new Date,pane:{},open:0,mode:0,appended:0,selectedDate:null,disabled:void 0},clickable=element.find(".datepicker-icon"),content=element.find("div.faux-input"),Liseners={};scope.$show=function(){copyEl=templateElem,1!==$directive.appended&&(element.append(copyEl),$directive.appended=1),copyEl.attr("aria-hidden","false"),copyEl.css({position:"absolute",display:"block"}),bindLiseners(),$directive.pane.month=1,$directive.open=1,scope.build()},scope.$watch("isDisabled",function(newV){$directive.disabled=newV,newV?disableElements(content):enableElements(content)}),content.bind("valueChanged",function(e,val){safeApply(scope,function(){validFormat(val,"dd/mm/yyyy")&&($directive.selectedDate=dateCalculator.getDate(val,"dd/mm/yyyy"),addTime($directive.selectedDate,scope.ngModel),$directive.viewDate=$directive.selectedDate,scope.build())})}),content.bind("focus",function(){currentSelected=null}),$.fn.bindFirst=function(name,fn){this.on(name,fn),this.each(function(){var handlers=$._data(this,"events")[name.split(".")[0]],handler=handlers.pop();handlers.splice(0,0,handler)})},scope.elemFocus=function(ev){setFocusButton($(ev.target),!1)},attr.trigger&&"focus"===attr.trigger&&content.bind("focus",function(){safeApply(scope,function(){scope.$show()})});var dayLabels=["ma","di","wo","do","vr","za","zo"];scope.labels=[];var isDateSupported=function(){var i=document.createElement("input");return i.setAttribute("type","date"),"text"!==i.type},isNative=/(ip(a|o)d|iphone|android)/gi.test($window.navigator.userAgent),isTouch="createTouch"in $window.document&&isNative&&isDateSupported();clickable.bind("mousedown touch",function(){return safeApply(scope,function(){$directive.disabled!==!0&&(isTouch?(element.find("input[type=date]:first").focus(),element.find("input[type=date]:first").click()):(currentSelected=null,$directive.open?scope.hide():(scope.$show(),content.focus())))}),!1});var options={yearTitleFormat:"mmmm yyyy",dateFormat:"dd/mm/yyyy"};scope.$selectPane=function(value,keyboard){$directive.viewDate=new Date(Date.UTC($directive.viewDate.getFullYear()+($directive.pane.year||0)*value,$directive.viewDate.getMonth()+($directive.pane.month||0)*value,1)),scope.build(),keyboard&&setTimeout(function(){var rijen=copyEl.find("tbody").children();1===value?setFocusButton($(rijen[0]).find("button:not(.btn-grayed):first")):-1===value&&setFocusButton($(rijen[rijen.length-1]).find("button:not(.btn-grayed):last"))},50)},scope.$toggleMode=function(){$directive.mode>=0&&$directive.mode<=1?$directive.mode+=1:$directive.mode=0,setMode($directive.mode),scope.build()},scope.hide=function(){copyEl&&(copyEl.css({display:"none"}),copyEl.attr("aria-hidden","true"),$directive.open=0,copyEl=null,removeLiseners(),safeApply(scope,function(){$directive.open=0,content.unbind("blur.disable")}))},scope.$disable=function($event){return $event.preventDefault(),!1},scope.$select=function(date){return addTime(date,scope.ngModel),$directive.click=1,$directive.viewDate=date,0===$directive.mode?(scope.ngModel=date,scope.hide(),setTimeout(function(){content.blur()},0)):$directive.mode>0&&($directive.mode-=1,setMode($directive.mode),scope.build()),!1};var currentSelected;scope.pane={prev:!1,next:!1},scope.build=function(){if((null===$directive.viewDate||void 0===$directive.viewDate)&&($directive.viewDate=new Date),checkBefore($directive.viewDate,scope.minDate)?(scope.pane.prev=!0,$directive.viewDate=new Date(scope.minDate)):scope.pane.prev=!1,checkAfter($directive.viewDate,scope.maxDate)?(scope.pane.next=!0,$directive.viewDate=new Date(scope.maxDate)):scope.pane.next=!1,scope.labels=[],1===$directive.mode&&(scope.title=dateCalculator.format($directive.viewDate,"yyyy"),scope.rows=calView.monthInRows($directive.viewDate,scope.minDate,scope.maxDate),scope.showLabels=0),0===$directive.mode&&(scope.title=dateCalculator.format($directive.viewDate,options.yearTitleFormat),scope.rows=calView.daysInRows($directive.viewDate,$directive.selectedDate,scope.minDate,scope.maxDate),scope.labels=$sce.trustAsHtml("<th>"+dayLabels.join("</th><th>")+"</th>")),2===$directive.mode){var currentYear=parseInt(dateCalculator.format($directive.viewDate,"yyyy"));scope.title=currentYear-11+"-"+currentYear,scope.rows=calView.yearInRows($directive.viewDate,scope.minDate,scope.maxDate)}};var templateElem,fetchPromises=[],promise=haalTemplateOp("templates/tinkDatePickerField.html");promise.then(function(template){angular.isObject(template)&&(template=template.data),templateElem=$compile(template),templateElem=templateElem(scope,function(){})})}}}}}])}(),angular.module("tink.datepicker").run(["$templateCache",function($templateCache){$templateCache.put("templates/tinkDatePickerField.html",'<div role=datepicker class="dropdown-menu datepicker" ng-class="\'datepicker-mode-\' + $mode"> <table style="table-layout: fixed; height: 100%; width: 100%"> <thead> <tr class=text-center> <th> <button tabindex=-1 type=button ng-disabled=pane.prev aria-label="vorige maand" class="btn pull-left" ng-mousedown=$disable($event) ng-click=$selectPane(-1)> <i class="fa fa-chevron-left"></i> </button> </th> <th colspan="{{ rows[0].length - 2 }}"> <button tabindex=0 type=button class="btn btn-block text-strong" ng-mousedown=$disable($event) ng-click=$toggleMode()> <strong style="text-transform: capitalize" ng-bind=title></strong> </button> </th> <th> <button tabindex=0 type=button ng-mousedown=$disable($event) ng-disabled=pane.next aria-label="volgende maand" class="btn pull-right" ng-click=$selectPane(+1)> <i class="fa fa-chevron-right"></i> </button> </th> </tr> <tr class=datepicker-days ng-bind-html=labels ng-if=showLabels></tr> </thead> <tbody> <tr ng-repeat="(i, row) in rows" height="{{ 100 / rows.length }}%"> <td class=text-center ng-repeat="(j, el) in row"> <button tabindex=0 type=button class=btn style="width: 100%" ng-class="{\'btn-selected\': el.selected, \'btn-today\': el.isToday && !el.elected, \'btn-grayed\':el.isMuted}" ng-mousedown=$disable($event) ng-focus=elemFocus($event) ng-click=$select(el.date) ng-disabled=el.disabled> <span role="" ng-class="{\'text-muted\': el.muted}" ng-bind=el.label></span> </button> </td> </tr> </tbody> </table> </div>'),$templateCache.put("templates/tinkDatePickerInput.html",'<div class=datepicker-input-fields tabindex=-1> <input role=date aria-label=datepicker tabindex=-1 data-is-disabled=isDisabled tink-format-input data-format=00/00/0000 data-placeholder=dd/mm/jjjj data-date dynamic-name=dynamicName data-max-date=maxDate data-min-date=minDate ng-model="ngModel">\n<span role="datepicker icon" class=datepicker-icon> <i class="fa fa-calendar"></i> </span> </div>')}]);
//# sourceMappingURL=tink-datepicker-angular.min.map